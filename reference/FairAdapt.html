<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fairadapt — fairadapt • Fair Data Adaptation</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fairadapt — fairadapt"><meta property="og:description" content="Implementation of fair data adaptation with quantile preservation
(Plecko &amp;amp; Meinshausen 2019). Uses only plain R."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Fair Data Adaptation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jss.pdf">fairadapt: Causal Reasoning for Fair Data Pre-processing (PDF)</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dplecko/fairadapt" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fairadapt</h1>
    
    <div class="hidden name"><code>fairadapt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implementation of fair data adaptation with quantile preservation
(Plecko &amp; Meinshausen 2019). Uses only plain <code>R</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fairadapt</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">prot.attr</span>,</span>
<span>  <span class="va">adj.mat</span>,</span>
<span>  <span class="va">train.data</span>,</span>
<span>  test.data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cfd.mat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top.ord <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  res.vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quant.method <span class="op">=</span> <span class="va">rangerQuants</span>,</span>
<span>  visualize.graph <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  eval.qfit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>Object of class <code>formula</code> describing the response and
the covariates.</p></dd>


<dt>prot.attr</dt>
<dd><p>A value of class <code>character</code> describing the binary
protected attribute. Must be one of the entries of <code>colnames(adj.mat)</code>.</p></dd>


<dt>adj.mat</dt>
<dd><p>Matrix of class <code>matrix</code> encoding the relationships in
the causal graph. <code>M[i,j] == 1L</code> implies the existence of an edge from
node i to node j. Must include all the variables appearing in the formula
object. When the <code>adj.mat</code> argument is set to <code>NULL</code>, then the
<code>top.ord</code> argument has to be supplied.</p></dd>


<dt>train.data, test.data</dt>
<dd><p>Training data &amp; testing data, both of class
<code>data.frame</code>. Test data is by default <code>NULL</code>.</p></dd>


<dt>cfd.mat</dt>
<dd><p>Symmetric matrix of class <code>matrix</code> encoding the
bidirected edges in the causal graph. <code>M[i,j] == M[j, i] == 1L</code>
implies the existence of a bidirected edge between nodes i and j. Must
include all the variables appearing in the formula object.</p></dd>


<dt>top.ord</dt>
<dd><p>A vector of class <code>character</code> describing the
topological ordering of the causal graph. Default value is <code>NULL</code>,
but this argument must be supplied if <code>adj.mat</code> is not specified.
Also must include all the variables appearing in the formula object.</p></dd>


<dt>res.vars</dt>
<dd><p>A vector of class <code>character</code> listing all the resolving
variables, which should not be changed by the adaption procedure. Default
value is <code>NULL</code>, corresponding to no resolving variables. Resolving
variables should be a subset of the descendants of the protected attribute.</p></dd>


<dt>quant.method</dt>
<dd><p>A function choosing the method used for quantile
regression. Default value is <code>rangerQuants</code> (using random forest
quantile regression). Other implemented options are <code>linearQuants</code> and
<code>mcqrnnQuants</code>. A custom function can be supplied by the user here,
and the associated method for the S3 generic <code>computeQuants</code> needs to be
added.</p></dd>


<dt>visualize.graph</dt>
<dd><p>A <code>logical</code> indicating whether the causal graph
should be plotted upon calling the <code>fairadapt()</code> function. Default
value is <code>FALSE</code>.</p></dd>


<dt>eval.qfit</dt>
<dd><p>Argument indicating whether the quality of the quantile
regression fit should be computed using cross-validation. Default value is
<code>NULL</code>, but whenever a positive integer value is specified, then it is
interpreted as the number of folds used in the cross-validation procedure.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments forwarded to the function passed as
<code>quant.method</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>fairadapt</code>, containing the original and
adapted training and testing data, together with the causal graph and some
additional meta-information.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The procedure takes the training and testing data as an input, together with
the causal graph given by an adjacency matrix and the list of resolving
variables, which should be kept fixed during the adaptation procedure. The
procedure then calculates a fair representation of the data, after which
any classification method can be used. There are, however, several valid
training options yielding fair predictions, and the best of them can be
chosen with cross-validation. For more details we refer the user to the
original paper. Most of the running time is due to the quantile regression
step using the ranger package.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Plecko, D. &amp; Meinshausen, N. (2019).
Fair Data Adaptation with Quantile Preservation</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">n_samp</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="va">uni_dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>       <span class="st">"gender"</span>, <span class="st">"edu"</span>, <span class="st">"test"</span>, <span class="st">"score"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">uni_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>       <span class="fl">0</span>,     <span class="fl">1</span>,      <span class="fl">1</span>,       <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                           <span class="fl">0</span>,     <span class="fl">0</span>,      <span class="fl">1</span>,       <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                           <span class="fl">0</span>,     <span class="fl">0</span>,      <span class="fl">0</span>,       <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                           <span class="fl">0</span>,     <span class="fl">0</span>,      <span class="fl">0</span>,       <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">uni_dim</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">uni_dim</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">uni_ada</span> <span class="op">&lt;-</span> <span class="fu">fairadapt</span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">.</span>,</span></span>
<span class="r-in"><span>  train.data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">uni_admission</span>, n <span class="op">=</span> <span class="va">n_samp</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test.data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">uni_admission</span>, n <span class="op">=</span> <span class="va">n_samp</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  adj.mat <span class="op">=</span> <span class="va">uni_adj</span>,</span></span>
<span class="r-in"><span>  prot.attr <span class="op">=</span> <span class="st">"gender"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">uni_ada</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fairadapt(formula = score ~ ., prot.attr = "gender", adj.mat = uni_adj, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     train.data = head(uni_admission, n = n_samp), test.data = tail(uni_admission, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         n = n_samp))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adapting variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   score, edu, test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Based on protected attribute gender </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   AND</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Based on causal graph:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        score gender edu test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score      0      0   0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gender     0      0   1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> edu        1      0   0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test       1      0   0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Drago Plecko, Nicolas Bennett.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

